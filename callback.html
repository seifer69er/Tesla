<!DOCTYPE html>
<html>
<head><title>Redirecting...</title></head>
<body>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        const state = urlParams.get('state');

        if (code) {
            const isAndroid = /Android/i.test(navigator.userAgent);
            
            if (isAndroid) {
                // This custom scheme 'teslapowerwall://' tells the Android OS 
                // to stop looking at the web and open the app immediately.
                window.location.href = "teslapowerwall://callback" + window.location.search;
            } else {
                // Windows: Send to the local listener
                window.location.href = "http://localhost:5000/?code=" + code + "&state=" + state;
            }
        }
    </script>
</body>
</html>